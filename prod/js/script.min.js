$(document).ready(function(){function e(){$.getJSON(o+"api/products",function(e){for(var a in e)$("<span></span>").addClass("product btn").attr("id",e[a].id).appendTo($("#productList")),$("<p></p>").text(e[a].title).appendTo($(".product")[a]),$("<img/>").attr("src","http://smktesting.herokuapp.com/static/"+e[a].img).addClass("img-responsive").appendTo($(".product")[a]),$("<p></p>").text(e[a].text).appendTo($(".product")[a]);var s;$(".product").click(function(){s=this,$("#reviewList li").detach(),n=s.id,i=o+"api/reviews/"+n,$("#titleRew").removeClass("hidden"),$(".rateRew").removeClass("hidden"),t(i)})})}function t(){$.getJSON(i,function(e){for(var t in e)$("<li></li>").addClass("productRew").attr("id",e[t].id).appendTo($("#reviewList")),$("<p></p>").text("Date: "+e[t].created_at).appendTo($("#reviewList li")[t]),$("<p></p>").text("Rate: "+e[t].rate).appendTo($("#reviewList li")[t]),$("<p></p>").text("Text: "+e[t].text).appendTo($("#reviewList li")[t])})}var a,n,i,o="http://smktesting.herokuapp.com/";a=0,$("#regBtn").on("click",function(e){e.preventDefault();var t,a=$("#newName").val(),n=$("#newPass").val(),i={username:a,password:n};t=JSON.stringify(i);$.ajax({type:"POST",contentType:"application/json",url:o+"api/register/",data:t,dataType:"json",success:function(e){e.success===!0?($("#modalReg").modal("hide"),$(".loginValidation").addClass("hidden"),$(".successSign").removeClass("hidden")):$(".validRegistration").removeClass("hidden")}})}),$("#logInBtn").on("click",function(e){e.preventDefault();var t=$("#logName").val(),n=$("#logPass").val(),i={username:t,password:n};jsonStr=JSON.stringify(i);$.ajax({type:"POST",contentType:"application/json",url:o+"api/login/",data:jsonStr,dataType:"json",success:function(e){e.success===!0?(a=e.token,$("#registrationMenu").addClass("hidden"),$(".exit").removeClass("hidden"),$(".rev_error").addClass("hidden")):$(".loginValidation").removeClass("hidden")}})}),$(".btnReview").on("click",function(e){0!=a?$.ajax({type:"POST",url:o+"api/reviews/"+n,data:{rate:$(":radio[name=star]:checked").val(),text:$("#content").val()},headers:{Authorization:"Token "+a},dataType:"json",success:function(){$("#content").val("")}}):$(".rev_error").removeClass("hidden")}),e(),$(".exit").click(function(){window.location.reload()})}),$(window).load(function(){$(".loader_inner").fadeOut(),$(".loader").delay(400).fadeOut("slow")});